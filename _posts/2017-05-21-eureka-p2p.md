---
layout: post
title:  Eureka服务发现问题的另一种解决方式
subtitle  : 操作及核心概念， P2P通信方式
tags : 微服务
---

## 服务发现为什么不用zookeeper?

&emsp;&emsp;类似的问题网络上已经有很多资料，就不详细解释。只谈以下几点， zookeeper本质上是一个CP系统，在多节点的情况下Leader选举比较耗时，并且会放大network partition 的问题。一旦分区出现时，在某个partition中 quorum 的数量不能满足多数派协议先决条件时，zookeeper client 会与server失联。但也并不是没有解决办法，
可以尝试在客户端做cache来做些弥补。总而言之一句话：zookeeper本质上为了解决分布式系统中为了某个值达成一致而设计，在这种前提下一致性是首要的需求。而对于服务发现跟服务注册来说，保证最大的可用性是第一位的。严格的来说用CP系统来构建一个AP系统并不是最好的解决办法。

## Eureka High Level Architecture

&emsp;&emsp;Erueka是基于REST的服务发现注册组件。轻量，方便与应用整合是其最大的特点。在实际的运行环境中Eureka跟应用程序的集成在同一个JVM进程内。在Eureka中主要包括以下几类角色：
*  Eureka Server ：对外暴露REST接口，提供服务注册，发现，续约，取消，剔除无效节点等服务。
*  Service Provider ：服务提供者，可以是任何微服务的业务提供方。
*  Service Consumer ：从Eureka获取服务注册的地址列表。

可见在微服务的环境中，服务提供方与服务使用方必须是从耦合的，服务的消费一方甚至不用感知这些服务的真是地址，所有的服务变更，fail over，load balance 都是由类似
Eureka的中间层来做的。

![](https://raw.githubusercontent.com/pangzhenzhou/pzz-github-pages-blog/gh-pages/public/image/eureka_architecture.png)
